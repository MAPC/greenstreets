{% extends "base.html" %}
{% load i18n %}

{% block javascript %}
<link rel="stylesheet" href="{{ STATIC_URL }}js/chosen/chosen.css">
<script src="{{ STATIC_URL }}js/chosen/chosen.jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">	
$(document).ready(function() {
	
	// initiate chosen dropdown UIs	
	$(".chzn-select").chosen();	

	// get schools for selected district
	$("#district-select").chosen().change(function(e) {
		districtid = $("#district-select option:selected").val();
		// get schools for given district-id
		$.getJSON("/" + districtid + "/schools/", function(schools) {
			// clear previouse dropdown options
			$("#school-select option").remove();
			// append new schools to dropdown
			$.each(schools, function(id, school) {
				$("<option value='" + school.url + "'>" + school.name + "</option>").appendTo("#school-select");
			});
			// refresh chosen UI
			$("#school-select").trigger("liszt:updated");
			// call change function to set initial school url
			$("#school-select").chosen().change();
		});
	});
	
	// go to school survey form
	$("#open-survey").click(function() {
		schoolurl = $("#school-select option:selected").val();
		window.location = schoolurl;
		return false;
	});
	
	// call change function to load initial schools
	$("#district-select").chosen().change();
	
});
</script>

{% endblock %}

{% block body %}
<div class="row">
	
	<div class="span16 columns">
		

		<h1>Welcome to the Walk/Ride Day Pledge and Check-In!</h1>

		<p>Completing this short survey each month enters you in our online raffles and other challenges that may come up during the 
			course of the year. It also helps us measure the impact of Walk/Ride Days and is vital for our fundraising and strategic 
			planning efforts.
		</p>

		<p>Thank you for participating and for checking in!</p>

		<p>The Green Streets Team<br />
			<a href="mailto:walk-ride-days@comcast.net?subject=Walk/Ride Day Check-In Question">walk-ride-days@comcast.net</a><br />
			<a href="http://www.gogreenstreets.org">www.GoGreenStreets.org</a>
		</p>

	</div>
	
	<div class="span8 columns">
		
		<h2>School Check-In</h2>
		
		<h3>{% trans "Please select your school district:" %}</h3>
		<p>Scroll or start typing your district name</p>
		<div class="input index">
			<select id="district-select" class="chzn-select" style="width: 350px;" tabindex="1">
				{% for district in districts %}<option value="{{ district.districtid }}">{{ district.distname }}</option> {% endfor %}
			</select>
		</div>
		
		<h3>{% trans "Please select your school:" %}</h3>
		<p>Scroll or start typing your school name</p>		
		<div class="input index">
			<select id="school-select" class="chzn-select" style="width: 350px;" tabindex="2"></select>
		</div>
		
		<a id="open-survey" href="#" class="btn primary large" tabindex="3">Open School Survey Form</a>
		
	</div>
	
	<div class="span8 columns">
		
		<h2>Work-Place Check-In</h2>
		<h3>Please select the town where you work:</h3>
		<p>Scroll or start typing the town name</p>		
		<div class="input index">
			<select id="town-select" class="chzn-select" style="width: 350px;" tabindex="4"></select>
		</div>
		
		<a id="open-employersurvey" href="#" class="btn primary large" tabindex="5">Open Employer Survey Form</a>
		
	</div>
	
</div>
{% endblock %}