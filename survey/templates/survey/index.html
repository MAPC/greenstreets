{% extends "base.html" %}
{% load i18n %}

{% block javascript %}
<link rel="stylesheet" href="{{ STATIC_URL }}js/chosen/chosen.css">
<script src="{{ STATIC_URL }}js/chosen/chosen.jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">	
$(document).ready(function() {
	
	// initiate chosen dropdown UIs	
	$(".chzn-select").chosen();	

	// get schools for selected district
	$("#district-select").chosen().change(function(e) {
		districtid = $("#district-select option:selected").val();
		// get schools for given district-id
		$.getJSON("/" + districtid + "/getschools/", function(schools) {
			// clear previouse dropdown options
			$("#school-select option").remove();
			// append new schools to dropdown
			$.each(schools, function(id, school) {
				$("<option value='" + school.url + "'>" + school.name + "</option>").appendTo("#school-select");
			});
			// refresh chosen UI
			$("#school-select").trigger("liszt:updated");
			// call change function to set initial school url
			$("#school-select").chosen().change();
		});
	});
	
	// go to school survey form
	$("#open-survey").click(function() {
		schoolurl = $("#school-select option:selected").val();
		window.location = schoolurl;
	});
	
	// call change function to load initial schools
	$("#district-select").chosen().change();
	
});
</script>

{% endblock %}

{% block body %}
<div class="row">
	<div class="span8 columns">

		<h2>{% trans "Please select your school district:" %}</h2>

		<div class="input index">
			<select id="district-select" class="chzn-select" style="width: 350px;" tabindex="1">
				{% for district in districts %}<option value="{{ district.districtid }}">{{ district.distname }}</option> {% endfor %}
			</select>
		</div>
	</div>
	
	<div class="span8 columns">
		<h2>{% trans "Please select your school:" %}</h2>
		
			<div class="input index">
				<select id="school-select" class="chzn-select" style="width: 350px;" tabindex="2"></select>
			</div>
	</div>
	
	<div class="span8 columns offset8">
		<a id="open-survey" href="#" class="btn primary" tabindex="3">Open School Survey Form</a>
	</div>
	
	
</div>
{% endblock %}